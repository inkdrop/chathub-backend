postgres:
  image: postgres:9.5
  ports:
    - "5432:5432"
  environment:
    POSTGRES_PASSWORD: postgres
    POSTGRES_USER: postgres
    POSTGRES_DB: chathub
  volumes:
    - /var/lib/postgresql

rabbitmq:
  image: rabbitmq:3-management
  ports:
    - "5672"
    - "15672:15672"
  volumes:
    - /var/lib/rabbitmq/
  environment:
    RABBITMQ_DEFAULT_USER: docker
    RABBITMQ_DEFAULT_PASS: docker

redis:
  image: redis
  ports:
    - "6379"
  volumes:
    - /data

chathub:
  image: luizkowalski/chathub
  ports:
    - "8080"
  links:
    - redis
    - postgres
    - rabbitmq

lb:
  image: 'dockercloud/haproxy:1.2.1'
  links:
    - chathub
  ports:
    - '80:80'
  roles:
    - global
